# specify language
language: node_js

# specify NodeJS version
node_js:
 - "10.15.0"
python:
  - "3.6"

jobs:
  include:
    # - stage: test
    #   # configure chrome
    #   before_install:
    #     - export CHROME_BIN=chromium-browser
    #     - export DISPLAY=:99.0
    #     - sh -e /etc/init.d/xvfb start
    #   # install dependencies
    #   install:
    #     - npm install
    #   # run unit tests only
    #   script:
    #     - npm run unit

    - stage: deploy-dev
          # if: branch = develop
      # configure ansible
      before_install:
        - sudo apt-get -y install python3-pip python-dev
        - pip3 install -U setuptools
        - pip3 install -U virtualenvwrapper
      install:
        - pip3 install ansible
      before_script:
        - git clone git@github.com:biojs/biojs-backend-ansible.git
      script:
        - cd biojs-backend-ansible && ansible-playbook dev-deploy.yml --private-key=~/.ssh/id_rsa -u ubuntu -i dev_hosts

# get notified through email
notifications:
 email: true
